<svg onload='b(event)' xmlns='http://www.w3.org/2000/svg'><script>//<![CDATA[
const b=(e)=>{const svg=e.target;(onhashchange=()=>{
  let R = location.href.split(/[?#]/)[1] || 'S=AX,=title,A=[+AX-AX-AX]-AX+AX+AX-,F=,X=F+F+F+FFF-F-F-F,_a=60,_n=3';
  R = 'string' === typeof R ? Object.fromEntries(R.replace(/&/g, ',').replace(/([^,:=]*)[:=]([^,:=]*)/g, '$1=$2').split(',').map(a => a.split('='))) : R;
  let T = performance.now(), [x, y, a, b, q, O] = Array(9).fill(0), d = '', p = 1, i, j, Q = Math.PI / 2;
  R.S ??= 'F'; R._a = R._a ?? 90; R._n ??= 1; R._l ??= 9; R._m ??= Q;
  const o = a => +parseFloat(a).toPrecision(12)
    , createStep = (E = 1, F = 2 * E) => {
    let lp = '0,0', LL, lines = new Set(), grid = {};
    let _min = 1 / 0, _max = -1 / 0, _all = 0, _cmp = 0, mx = _min, Mx = _max, my = _min, My = _max,
      [lx, ly] = align(0, 0), lall = 0;
      function oo(s) { return s.split(',').map(o).join(','); }
    function align(X, Y) {
      let ps, p, d, i, j, k,
        D = Infinity, P = null,
        x = Math.floor(X / F),
        y = Math.floor(Y / F),
        e = Math.ceil(E / F);
      for (j = -e; j <= e; j++) for (i = -e; i <= e; i++) {
        ps = grid[`${x + i},${y + j}`];
        if (ps) for (k = 0; k < ps.length; k++) {
          p = ps[k];
          d = Math.hypot(p[0] - X, p[1] - Y);
          if (d < D) { D = d; P = p; }
          _cmp++; _max < d && d < E && (_max = d); E < d && d < _min && (_min = d);
        }
      } _all++;
      if (D >= E) (grid[`${x},${y}`] ??= []).push(P = [X, Y]);
      return P;
    }
    return {
      stat: function () {
        const grids = Object.keys(grid).length;
        const points = Object.values(grid).reduce((p, c) => p + c.length, 0);
        return {
            err: points - grids, ms: (performance.now() - T | 0), B: O>=1e6?(O / 1e6).toFixed(6):O,
            lg: Math.log(_max)|0, len: _min.toExponential(2), dot: points, line: lines.size
        };
      },
      vb: function (m) { return [mx - m, my - m, Mx - mx + 2 * m, My - my + 2 * m]; },
      put: function (x, y, L) {
        let XY = align(x, y);[x, y] = XY; let p = `${x},${y}`;
        if (L) {
          const l = lp < p ? `${lp} ${p}` : `${p} ${lp}`;
          lall++;
          if (!lines.has(l)) {
            lines.add(l);
              if (!LL || lp !== p) { d += `M${oo(lp)}`; LL = true; }
              d += ` ${oo(p)}`;
            mx = Math.min(x, lx, mx);
            Mx = Math.max(x, lx, Mx);
            my = Math.min(y, ly, my);
            My = Math.max(y, ly, My);
          }
        } else { LL = false; }
        lp = p; lx = x; ly = y;
        return XY;
      },
    };
  }
    , Z = Object.fromEntries(Object.entries(R).filter(([k]) => k.endsWith('2')).map(([k, v]) => [k[0], v]))
    , z = [], u = n => Z && n === R._n ? Z : R, B = R._a / 90
    , D = createStep(1e-3)
    , C = (t, a, ...b) => {
      t = document.createElementNS('http://www.w3.org/2000/svg', t);
      for (i in a) t.setAttribute(i, a[i]);
      b?.map(b => t.prepend(b));
      return t;
    }, f = f => R._l * Math.pow(R._m, q) * f(Q * (a * B + b));
  for (i of function* g(n) { if (n > 0) for (j of g(n - 1)) yield* u(n)?.[j] ?? j; else yield* R.S; }(R._n)) ++O &&
    'F' === i || 'f' === i ? [x, y] = D.put(x + f(Math.cos), y + f(Math.sin), 'F' === i) :
    '+' === i ? a += p : '*' === i ? q++ : '|' === i ? b = (b + 2) % 4 :
    '-' === i ? a -= p : '/' === i ? q-- : '^' === i ? b = (b + p + 4) % 4 :
    '!' === i ? p = -p :
    '[' === i ? z.push([x, y, a, b, q]) :
    ']' === i ? z.length && ([x, y, a, b, q] = z.pop(), D.put(x, y)) : 0;
  [x, y, a, b] = D.vb(R._P ?? 2).map(o);
  try { console.log(Object.entries(D.stat()).map(([k,v])=>v+' '+k).join(' ')); } catch (e) { }
  svg ||= C('svg');
  svg.setAttribute('viewBox', `${R._x ?? x} ${R._y ?? y} ${R._w ?? a} ${R._h ?? b}`);
  svg.replaceChildren(
    (t => (t.textContent = R?.[''] ?? 'a', t))(C('title')),
    (t => (t.textContent = JSON.stringify({ ...D.stat(), R: Object.keys(R).sort().map(k => `${k}=${R[k]}`).join(',') }), t))(C('desc')),
    C('rect', { fill: `#${R._b ?? 'fff'}`, x, y, width: a, height: b }),
    C('defs', 0, C('marker', { id: 'm', viewBox: '-3 -3 6 6' }, C('circle', { r: 1, fill: '#000' }))),
    C('path', {
      stroke: R._d == '1' ? 'none' : '#000', fill: 'none', 'stroke-linecap': 'round', 'stroke-linejoin': 'round',
      ...R._d  == '1' && ['start', 'mid', 'end'].reduce((p, c) => (p['marker-' + c] = 'url(#m)', p), {}), d
    }),
  );
  return svg;
})(e.target)}//]]></script>
<path stroke='#000' stroke-linecap='round' stroke-linejoin='round' fill='none'/>
</svg>